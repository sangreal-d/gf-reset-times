<!DOCTYPE html>
<html lang="en">
    <head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-5V55JHGSEJ"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-5V55JHGSEJ');
        </script>

        <link rel="manifest" href="/gf-reset-times/manifest.json">
        <link rel="apple-touch-icon" href="/gf-reset-times/icon-192.png">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="theme-color" content="#1C1C1E">
        <title>Family Dynasty Times</title>

        <style>
            /* --- all your CSS unchanged --- */
            * { margin: 0; padding: 0; box-sizing: border-box; }
            :root { --ios-blue:#007AFF; --ios-gray:#8E8E93; --ios-light-gray:#F2F2F7; --ios-dark-gray:#1C1C1E; --ios-secondary-gray:#3A3A3C; --ios-tertiary-gray:#48484A; --ios-green:#34C759; --ios-orange:#FF9500; --ios-background:#000000; --ios-card-bg:#1C1C1E; --ios-separator:#38383A; --text-primary:#FFFFFF; --text-secondary:#8E8E93; }
            [data-theme="light"] { --ios-background:#F2F2F7; --ios-card-bg:#FFFFFF; --ios-separator:#C6C6C8; --text-primary:#000000; --text-secondary:#8E8E93; --ios-secondary-gray:#F2F2F7; --ios-tertiary-gray:#E5E5EA; }
            [data-theme="dark"] { --ios-background:#000000; --ios-card-bg:#1C1C1E; --ios-separator:#38383A; --text-primary:#FFFFFF; --text-secondary:#8E8E93; --ios-secondary-gray:#3A3A3C; --ios-tertiary-gray:#48484A; }
            body { font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display','SF Pro Text',system-ui,sans-serif; background:var(--ios-background); color:var(--text-primary); min-height:100vh; padding:0; }
            .container { max-width:430px; margin:0 auto; padding:0 20px; padding-top:calc(env(safe-area-inset-top,20px) + 40px); padding-bottom:20px; position:relative; }
            .theme-toggle { position:absolute; top:20px; right:20px; background:var(--ios-card-bg); border:1px solid var(--ios-separator); border-radius:24px; padding:8px 16px; color:var(--text-primary); font-size:15px; font-weight:600; cursor:pointer; transition:all 0.2s ease; display:flex; align-items:center; gap:8px; z-index:100; }
            .theme-toggle:hover { background:var(--ios-secondary-gray); }
            .theme-toggle:active { transform:scale(0.95); }
            .theme-toggle svg { width:16px; height:16px; }
            .header { text-align:center; padding:24px 0 32px 0; margin-top:16px; }
            .header h1 { font-size:28px; font-weight:700; letter-spacing:-0.02em; margin-bottom:8px; }
            .header p,.header .note { font-size:13px; color:var(--text-secondary); margin-bottom:4px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:100%; }
            @media (max-width:400px){.header p,.header .note{font-size:12px;}}
            .timezone-section { background:var(--ios-card-bg); border-radius:16px; padding:20px; margin-bottom:24px; border:1px solid var(--ios-separator); }
            .timezone-row { display:flex; align-items:center; justify-content:space-between; gap:16px; flex-wrap:wrap; }
            .timezone-info { min-width:0; flex:1 1 120px; }
            .timezone-display { font-size:20px; font-weight:600; color:var(--text-primary); word-break:break-all; overflow-wrap:anywhere; }
            @media (max-width:500px){.timezone-row{flex-direction:row;flex-wrap:wrap;align-items:center;justify-content:space-between;width:100%;}.timezone-info{flex:1 1 60%;min-width:120px;}.change-button{flex:1 1 auto;text-align:right;margin-top:4px;}.timezone-display{font-size:17px;}}
            @media (max-width:375px){.change-button{text-align:left;width:100%;}}
            .change-button { background:var(--ios-secondary-gray); border:none; border-radius:24px; padding:12px 20px; color:var(--ios-blue); font-size:15px; font-weight:600; cursor:pointer; transition:all 0.2s ease; display:flex; align-items:center; gap:8px; white-space:nowrap; }
            .change-button:hover { background:var(--ios-tertiary-gray); }
            .change-button:active { transform:scale(0.95); }
            .change-button:focus-visible { outline:2px solid var(--ios-blue); outline-offset:2px; }
            .timezone-select { width:100%; background:transparent; border:none; color:var(--text-primary); font-size:20px; font-weight:700; letter-spacing:-0.02em; margin-top:4px; cursor:pointer; appearance:none; font-family:inherit; }
            .timezone-select:focus-visible { outline:none; box-shadow:0 0 0 2px var(--ios-blue); }
            .timezone-select option { background:var(--ios-card-bg); color:var(--text-primary); }
            .events-list { display:flex; flex-direction:column; gap:16px; margin-bottom:32px; }
            .event-card { background:var(--ios-card-bg); border-radius:16px; padding:20px; border:1px solid var(--ios-separator); }
            .event-content { display:flex; align-items:flex-end; justify-content:flex-start; gap:24px; }
            .event-info { flex:0 1 220px; min-width:0; }
            .event-time { flex:0 0 auto; min-width:80px; text-align:right; display:flex; flex-direction:column; align-items:flex-end; justify-content:flex-end; }
            .special-days { color:var(--ios-orange); font-weight:600; margin-bottom:4px; padding:4px 10px; background:rgba(255,149,0,0.13); border-radius:8px; border:1px solid rgba(255,149,0,0.22); font-size:13px; display:inline-block; max-width:100%; box-shadow:0 1px 2px 0 rgba(255,149,0,0.04); }
            .event-utc { font-size:12px; color:var(--text-secondary); margin-bottom:0; display:block; }
            .event-title { font-size:22px; font-weight:700; letter-spacing:-0.02em; margin-bottom:0; color:var(--text-primary); }
            .ios-clock-time { display:flex; align-items:baseline; gap:2px; }
            .ios-clock-hour { font-size:36px; font-weight:700; letter-spacing:-0.02em; color:var(--text-primary); line-height:1; }
            .ios-clock-ampm { font-size:20px; font-weight:500; color:var(--text-primary); margin-left:2px; letter-spacing:0.01em; line-height:1; }
            .special-times { display:flex; flex-direction:column; align-items:flex-end; gap:4px; }
            .footer { text-align:center; margin-top:32px; padding:0 0 32px 0; color:var(--text-secondary); font-size:13px; line-height:1.5; }
            .footer .signature { font-size:11px; color:var(--text-secondary); margin-top:10px; opacity:0.8; }
            .globe-icon { width:18px; height:18px; }
            .timezone-select.hidden { display:none; }
            .timezone-display.hidden { display:none; }
            @media (max-width:375px){.ios-clock-hour{font-size:26px;}.ios-clock-ampm{font-size:18px;}.event-title{font-size:18px;}.special-days,.event-utc{font-size:11px;}.timezone-info{max-width:120px;}}
        </style>
    </head>
    <body>
        <div class="container">
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                <svg id="themeIcon" viewBox="0 0 24 24" fill="currentColor">
                    <path class="sun-icon" d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/>
                    <path class="moon-icon" style="display:none;" d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-3.03 0-5.5-2.47-5.5-5.5 0-1.82.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/>
                </svg>
                <span id="themeText">Light</span>
            </button>
            <div class="header">
                <h1>Family Dynasty Times</h1>
                <p>Track server reset times for The Godfather: Family Dynasty</p>
                <div class="note">All server events run on UTC time</div>
            </div>
            <div class="timezone-section" role="region" aria-labelledby="timezoneHeading">
                <div class="timezone-row">
                    <div class="timezone-info">
                        <span class="timezone-label" id="timezoneHeading">Your Timezone</span>
                        <div class="timezone-display" id="timezoneDisplay" aria-live="polite">Loading...</div>
                        <select class="timezone-select hidden" id="timezoneSelect" aria-labelledby="timezoneHeading"></select>
                    </div>
                    <button class="change-button" id="changeBtn" aria-expanded="false" aria-controls="timezoneSelect">
                        <svg class="globe-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                        </svg>
                        Change
                    </button>
                </div>
            </div>
            <div class="events-list" id="eventsList"></div>
            <div class="footer">
                <p>
                    All times are converted to your local or selected timezone.<br>
                    Plan your gameplay accordingly.
                </p>
                <p class="signature">
                    This tool is a reference only.<br>
                    Always double-check times in-game to be sure.<br>
                    Created by sangreal for [MØB] Worldwide Mob · 102-3
                </p>
            </div>
        </div>
        <script>
            // Event definitions
            const events = [
                { title: 'Main Reset', utcTime: '00:00 UTC', time: '00:00' },
                { title: 'License Refresh', utcTime: '08:00 UTC', time: '08:00' },
                { title: 'NG Bonus', utcTime: '22:00 UTC', time: '22:00' },
                {
                    title: 'FCL/KCL events',
                    utcTime: '14:00 UTC | 21:00 UTC',
                    times: ['14:00', '21:00'],
                    days: 'Tue, Thu, Sat',
                    isSpecial: true
                }
            ];
            // App state
            const state = {
                userTimezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                selectedTimezone: localStorage.getItem('selectedTimezone') || 'auto',
                isSelectMode: false
            };
            // DOM elements
            const elements = {
                timezoneDisplay: document.getElementById('timezoneDisplay'),
                timezoneSelect: document.getElementById('timezoneSelect'),
                changeBtn: document.getElementById('changeBtn'),
                eventsList: document.getElementById('eventsList')
            };
            // Theme handling
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = document.getElementById('themeIcon');
            const themeText = document.getElementById('themeText');
            function initTheme() {
                const savedTheme = localStorage.getItem('theme') || 'dark';
                document.documentElement.setAttribute('data-theme', savedTheme);
                updateThemeUI(savedTheme);
            }
            function updateThemeUI(theme) {
                const sunIcon = themeIcon.querySelector('.sun-icon');
                const moonIcon = themeIcon.querySelector('.moon-icon');
                if (theme === 'dark') {
                    sunIcon.style.display = 'block';
                    moonIcon.style.display = 'none';
                    themeText.textContent = 'Light';
                } else {
                    sunIcon.style.display = 'none';
                    moonIcon.style.display = 'block';
                    themeText.textContent = 'Dark';
                }
            }
            function toggleTheme() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateThemeUI(newTheme);
            }
            themeToggle.addEventListener('click', toggleTheme);
            // --- Timezone dropdown logic ---
            function getTimezoneLabel(tzValue) {
                const timezones = [
                    { value: 'auto', label: 'Auto-detect (Recommended)' },
                    { value: 'UTC', label: 'UTC' },
                    { value: 'Pacific/Honolulu', label: 'Hawaii' },
                    { value: 'America/Anchorage', label: 'Alaska' },
                    { value: 'America/Los_Angeles', label: 'Pacific Time' },
                    { value: 'America/Denver', label: 'Mountain Time' },
                    { value: 'America/Chicago', label: 'Central Time' },
                    { value: 'America/New_York', label: 'Eastern Time' },
                    { value: 'America/Caracas', label: 'Venezuela' },
                    { value: 'America/Sao_Paulo', label: 'Brazil' },
                    { value: 'Atlantic/Azores', label: 'Azores' },
                    { value: 'Europe/London', label: 'London' },
                    { value: 'Europe/Paris', label: 'Paris/Berlin' },
                    { value: 'Europe/Rome', label: 'Rome' },
                    { value: 'Europe/Athens', label: 'Athens' },
                    { value: 'Europe/Moscow', label: 'Moscow' },
                    { value: 'Europe/Samara', label: 'Samara' },
                    { value: 'Asia/Yekaterinburg', label: 'Yekaterinburg' },
                    { value: 'Asia/Omsk', label: 'Omsk' },
                    { value: 'Asia/Krasnoyarsk', label: 'Krasnoyarsk' },
                    { value: 'Asia/Irkutsk', label: 'Irkutsk' },
                    { value: 'Asia/Yakutsk', label: 'Yakutsk' },
                    { value: 'Asia/Vladivostok', label: 'Vladivostok' },
                    { value: 'Asia/Magadan', label: 'Magadan' },
                    { value: 'Asia/Kamchatka', label: 'Kamchatka' },
                    { value: 'Asia/Dubai', label: 'Dubai' },
                    { value: 'Asia/Karachi', label: 'Pakistan' },
                    { value: 'Asia/Kolkata', label: 'India' },
                    { value: 'Asia/Dhaka', label: 'Bangladesh' },
                    { value: 'Asia/Bangkok', label: 'Thailand' },
                    { value: 'Asia/Shanghai', label: 'China' },
                    { value: 'Asia/Tokyo', label: 'Japan' },
                    { value: 'Asia/Seoul', label: 'South Korea' },
                    { value: 'Australia/Perth', label: 'Perth' },
                    { value: 'Australia/Adelaide', label: 'Adelaide' },
                    { value: 'Australia/Sydney', label: 'Sydney/Melbourne' },
                    { value: 'Pacific/Auckland', label: 'New Zealand' }
                ];
                const found = timezones.find(tz => tz.value === tzValue);
                return found ? found.label : tzValue;
            }
            function getTimezoneOffset(timezone) {
                if (timezone === 'UTC') return '+00:00';
                try {
                    const date = new Date();
                    // Use UTC time for offset calculation
                    const options = { timeZone: timezone, hour: '2-digit', minute: '2-digit', hour12: false };
                    const localParts = new Intl.DateTimeFormat('en-US', options).formatToParts(date);
                    const localHour = parseInt(localParts.find(p => p.type === 'hour').value, 10);
                    const localMinute = parseInt(localParts.find(p => p.type === 'minute').value, 10);
                    const utcHour = date.getUTCHours();
                    const utcMinute = date.getUTCMinutes();
                    let offsetMinutes = (localHour - utcHour) * 60 + (localMinute - utcMinute);
                    // Adjust for day wrap
                    if (offsetMinutes <= -720) offsetMinutes += 1440;
                    if (offsetMinutes > 720) offsetMinutes -= 1440;
                    const sign = offsetMinutes >= 0 ? '+' : '-';
                    const absMinutes = Math.abs(offsetMinutes);
                    const hours = String(Math.floor(absMinutes / 60)).padStart(2, '0');
                    const minutes = String(absMinutes % 60).padStart(2, '0');
                    return `${sign}${hours}:${minutes}`;
                } catch (error) {
                    return '+00:00';
                }
            }
            function updateTimezoneDisplay() {
                let displayValue, offset;
                if (state.selectedTimezone === 'auto') {
                    displayValue = getTimezoneLabel(state.userTimezone);
                    offset = getTimezoneOffset(state.userTimezone);
                } else {
                    displayValue = getTimezoneLabel(state.selectedTimezone);
                    offset = getTimezoneOffset(state.selectedTimezone);
                }
                elements.timezoneDisplay.textContent = `${displayValue} (UTC${offset})`;
            }
            function populateTimezoneOptions() {
                const timezones = [
                    { value: 'auto', label: 'Auto-detect (Recommended)' },
                    { value: 'UTC', label: 'UTC' },
                    { value: 'Pacific/Honolulu', label: 'Hawaii' },
                    { value: 'America/Anchorage', label: 'Alaska' },
                    { value: 'America/Los_Angeles', label: 'Pacific Time' },
                    { value: 'America/Denver', label: 'Mountain Time' },
                    { value: 'America/Chicago', label: 'Central Time' },
                    { value: 'America/New_York', label: 'Eastern Time' },
                    { value: 'America/Caracas', label: 'Venezuela' },
                    { value: 'America/Sao_Paulo', label: 'Brazil' },
                    { value: 'Atlantic/Azores', label: 'Azores' },
                    { value: 'Europe/London', label: 'London' },
                    { value: 'Europe/Paris', label: 'Paris/Berlin' },
                    { value: 'Europe/Rome', label: 'Rome' },
                    { value: 'Europe/Athens', label: 'Athens' },
                    { value: 'Europe/Moscow', label: 'Moscow' },
                    { value: 'Europe/Samara', label: 'Samara' },
                    { value: 'Asia/Yekaterinburg', label: 'Yekaterinburg' },
                    { value: 'Asia/Omsk', label: 'Omsk' },
                    { value: 'Asia/Krasnoyarsk', label: 'Krasnoyarsk' },
                    { value: 'Asia/Irkutsk', label: 'Irkutsk' },
                    { value: 'Asia/Yakutsk', label: 'Yakutsk' },
                    { value: 'Asia/Vladivostok', label: 'Vladivostok' },
                    { value: 'Asia/Magadan', label: 'Magadan' },
                    { value: 'Asia/Kamchatka', label: 'Kamchatka' },
                    { value: 'Asia/Dubai', label: 'Dubai' },
                    { value: 'Asia/Karachi', label: 'Pakistan' },
                    { value: 'Asia/Kolkata', label: 'India' },
                    { value: 'Asia/Dhaka', label: 'Bangladesh' },
                    { value: 'Asia/Bangkok', label: 'Thailand' },
                    { value: 'Asia/Shanghai', label: 'China' },
                    { value: 'Asia/Tokyo', label: 'Japan' },
                    { value: 'Asia/Seoul', label: 'South Korea' },
                    { value: 'Australia/Perth', label: 'Perth' },
                    { value: 'Australia/Adelaide', label: 'Adelaide' },
                    { value: 'Australia/Sydney', label: 'Sydney/Melbourne' },
                    { value: 'Pacific/Auckland', label: 'New Zealand' }
                ];
                elements.timezoneSelect.innerHTML = '';
                timezones.forEach(tz => {
                    const option = document.createElement('option');
                    option.value = tz.value;
                    let offset;
                    if (tz.value === 'auto') {
                        // Show user's current offset for auto
                        offset = getTimezoneOffset(Intl.DateTimeFormat().resolvedOptions().timeZone);
                        option.textContent = `${tz.label} (UTC${offset})`;
                    } else {
                        offset = getTimezoneOffset(tz.value);
                        option.textContent = `${tz.label} (UTC${offset})`;
                    }
                    elements.timezoneSelect.appendChild(option);
                });
            }
            // --- iOS clock style time formatting ---
            function convertUTCToLocalParts(utcTime) {
                try {
                    const [hours, minutes] = utcTime.split(':').map(Number);
                    const utcDate = new Date();
                    utcDate.setUTCHours(hours, minutes, 0, 0);
                    const formatter = new Intl.DateTimeFormat('en-US', {
                        timeZone: state.userTimezone,
                        hour: 'numeric',
                        minute: '2-digit',
                        hour12: true
                    });
                    const parts = formatter.formatToParts(utcDate);
                    const hour = parts.find(p => p.type === 'hour').value;
                    const minute = parts.find(p => p.type === 'minute').value;
                    const dayPeriod = parts.find(p => p.type === 'dayPeriod').value;
                    return { hour, minute, dayPeriod };
                } catch (error) {
                    return { hour: '--', minute: '--', dayPeriod: '' };
                }
            }
            function iosClockTimeHTML(utcTime) {
                const { hour, minute, dayPeriod } = convertUTCToLocalParts(utcTime);
                return `<span class="ios-clock-time">
                    <span class="ios-clock-hour">${hour}:${minute}</span>
                    <span class="ios-clock-ampm">${dayPeriod}</span>
                </span>`;
            }
            function createEventCard(event) {
                const card = document.createElement('div');
                card.className = 'event-card';
                if (event.isSpecial) {
                    const times = event.times.map(time => iosClockTimeHTML(time));
                    card.innerHTML = `
                        <div class="event-content">
                            <div class="event-info">
                                <div class="special-days">${event.days}</div>
                                <div class="event-utc">${event.utcTime}</div>
                                <div class="event-title">${event.title}</div>
                            </div>
                            <div class="event-time">
                                <div class="special-times">
                                    ${times.map(time => `<div>${time}</div>`).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    const localTime = iosClockTimeHTML(event.time);
                    card.innerHTML = `
                        <div class="event-content">
                            <div class="event-info">
                                <div class="event-utc">${event.utcTime}</div>
                                <div class="event-title">${event.title}</div>
                            </div>
                            <div class="event-time">
                                ${localTime}
                            </div>
                        </div>
                    `;
                }
                return card;
            }
            function renderEvents() {
                elements.eventsList.innerHTML = '';
                events.forEach((event, index) => {
                    const eventCard = createEventCard(event);
                    eventCard.style.animationDelay = `${0.1 * index}s`;
                    elements.eventsList.appendChild(eventCard);
                });
            }
            function setupEventListeners() {
                elements.changeBtn.addEventListener('click', toggleTimezoneSelect);
                elements.timezoneSelect.addEventListener('change', handleTimezoneChange);
                elements.timezoneSelect.addEventListener('blur', hideTimezoneSelect);
            }
            function toggleTimezoneSelect() {
                if (state.isSelectMode) {
                    hideTimezoneSelect();
                } else {
                    elements.timezoneDisplay.classList.add('hidden');
                    elements.timezoneSelect.classList.remove('hidden');
                    state.isSelectMode = true;
                    elements.changeBtn.setAttribute('aria-expanded', 'true');
                    setTimeout(() => {
                        elements.timezoneSelect.focus();
                        elements.timezoneSelect.click();
                    }, 0);
                }
            }
            function hideTimezoneSelect() {
                elements.timezoneDisplay.classList.remove('hidden');
                elements.timezoneSelect.classList.add('hidden');
                state.isSelectMode = false;
                elements.changeBtn.setAttribute('aria-expanded', 'false');
            }
            function handleTimezoneChange(e) {
                state.selectedTimezone = e.target.value;
                localStorage.setItem('selectedTimezone', state.selectedTimezone);
                if (state.selectedTimezone === 'auto') {
                    state.userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                } else {
                    state.userTimezone = state.selectedTimezone;
                }
                updateTimezoneDisplay();
                renderEvents();
                hideTimezoneSelect();
            }
            // --- INIT FUNCTION ---
            function init() {
                initTheme();
                if (state.selectedTimezone !== 'auto') {
                    state.userTimezone = state.selectedTimezone;
                } else {
                    state.userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                }
                updateTimezoneDisplay();
                populateTimezoneOptions();
                renderEvents();
                setupEventListeners();
                elements.timezoneSelect.value = state.selectedTimezone;
            }
            document.addEventListener('DOMContentLoaded', init);
        </script>
        <script>
            if ("serviceWorker" in navigator) {
                navigator.serviceWorker.register("/gf-reset-times/sw.js")
                .then(reg => console.log("SW registered:", reg.scope))
                .catch(err => console.error("SW registration failed:", err));
            }
        </script>
    </body>
</html>
